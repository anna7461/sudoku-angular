<!-- Header Component -->
<app-header 
  (openSettings)="onOpenSettings()" 
  (openHelp)="onOpenHelp()">
</app-header>

<div class="dashboard-container">
  <!-- Hearts and Streaks Section -->
  <section class="hearts-streaks-section">
    <!-- Hearts Container - Only show for Arcade Mode -->
    <div class="hearts-container" *ngIf="isArcadeMode()">
      <h3 class="section-title">Lives</h3>
      <div class="hearts-display">
        <div 
          *ngFor="let isFilled of getHeartsArray(); let i = index"
          class="heart"
          [class.filled]="isFilled"
          [class.empty]="!isFilled"
        >
          {{ isFilled ? '‚ù§Ô∏è' : 'üñ§' }}
        </div>
      </div>
    </div>
    
    <!-- Streaks Container - Always show -->
    <div class="streaks-container" [class.full-width]="!isArcadeMode()">
      <div class="streak-item">
        <span class="streak-label">Current Streak</span>
        <span class="streak-value">{{ currentStreak }}</span>
      </div>
      <div class="streak-item">
        <span class="streak-label">Best Streak</span>
        <span class="streak-value">{{ bestStreak }}</span>
      </div>
    </div>
  </section>

  <!-- Game Mode Cards -->
  <section class="game-modes">
    <div class="game-modes-grid">
      <div 
        *ngFor="let mode of gameModes" 
        class="game-mode-card"
        [class.coming-soon]="mode.isComingSoon"
        [class.completed]="mode.id === 'daily-challenge' && isDailyChallengeCompleted()"
        (click)="onGameModeClick(mode)"
      >
        <div class="mode-icon">{{ mode.icon }}</div>
        <div class="mode-content">
          <h3 class="mode-label">{{ mode.name }}</h3>
          <p class="mode-description">{{ mode.description }}</p>
          <button 
            class="mode-button"
            [class.disabled]="mode.isComingSoon"
            [class.completed]="mode.id === 'daily-challenge' && isDailyChallengeCompleted()"
            [disabled]="mode.isComingSoon">
            {{ getModeButtonText(mode) }}
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- Continue Game Button (only visible if saved game exists) -->
  <section *ngIf="savedGameInfo.exists" class="continue-section">
    <button class="continue-button primary-button" (click)="onContinueGame()">
      <div class="continue-content">
        <span class="continue-label">Continue</span>
        <span class="continue-details">
          {{ savedGameInfo.timeElapsed }} ¬∑ {{ savedGameInfo.difficulty }}
        </span>
      </div>
    </button>
  </section>

  <!-- New Game Button -->
  <section class="new-game-section">
    <button class="new-game-button secondary-button" (click)="onNewGame()">
      New Game
    </button>
  </section>

  <!-- Difficulty Selection Overlay -->
  <div 
    *ngIf="showDifficultyOverlay" 
    class="difficulty-overlay"
    (click)="onOverlayClick($event)"
  >
    <div class="difficulty-modal">
      <div class="modal-header">
        <h2>Select Difficulty</h2>
        <button class="close-button" (click)="closeDifficultyOverlay()">
          ‚úï
        </button>
      </div>
      <div class="difficulty-options">
        <button 
          *ngFor="let difficulty of ['test', 'easy', 'medium', 'hard', 'expert']"
          class="difficulty-option"
          [class.selected]="selectedDifficulty === difficulty"
          (click)="onDifficultySelect(difficulty)"
        >
          <span class="difficulty-icon">{{ getDifficultyIcon(difficulty) }}</span>
          <span class="difficulty-label">{{ getDifficultyLabel(difficulty) }}</span>
          <span class="difficulty-description">{{ getDifficultyDescription(difficulty) }}</span>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Settings Overlay -->
<app-settings-overlay 
  *ngIf="showSettingsOverlay" 
  (close)="onCloseSettings()">
</app-settings-overlay>

<!-- Help Overlay -->
<app-help-overlay 
  *ngIf="showHelpOverlay" 
  (close)="onCloseHelp()">
</app-help-overlay>

<!-- Daily Challenge Calendar Overlay -->
<div 
  *ngIf="showDailyChallengeCalendar" 
  class="daily-challenge-overlay"
  (click)="onCloseDailyChallengeCalendar()">
  <div class="overlay-content" (click)="$event.stopPropagation()">
    <app-daily-challenge-calendar
      (closeCalendar)="onCloseDailyChallengeCalendar()"
      (startChallenge)="onStartDailyChallenge($event)">
    </app-daily-challenge-calendar>
  </div>
</div>

<!-- Daily Challenge Results Overlay -->
<div 
  *ngIf="showDailyChallengeResults" 
  class="daily-challenge-overlay"
  (click)="onCloseDailyChallengeResults()">
  <div class="overlay-content" (click)="$event.stopPropagation()">
    <app-daily-challenge-results
      (closeResults)="onCloseDailyChallengeResults()"
      (viewCalendar)="onViewCalendarFromResults()"
      (continueChallenge)="onContinueDailyChallenge()">
    </app-daily-challenge-results>
  </div>
</div>
