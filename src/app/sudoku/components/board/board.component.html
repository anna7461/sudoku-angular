<div class="board">
  <div class="box" *ngFor="let box of boxes; let boxIndex = index">
    <div class="cell"
         *ngFor="let cell of box.cells; let cellIndex = index"
         [class.fixed]="cell.isFixed"
         [class.selected]="isCellSelected(boxIndex, cellIndex)"
         [class.correct]="cell.state === 'correct'"
         [class.error]="cell.state === 'error'"
         [class.fixed-selected]="cell.isFixed && isCellSelected(boxIndex, cellIndex)"
         [class.number-highlighted]="isNumberHighlighted(boxIndex, cellIndex)"
         [class.current-number-highlighted]="isCurrentNumberHighlighted(boxIndex, cellIndex)"
         [class.related-highlighted]="isRelatedHighlighted(boxIndex, cellIndex)"
         (click)="onCellClick(boxIndex, cellIndex)">
      @if (cell.value) {
        <div class="main-number">{{ cell.value }}</div>
      }
      @if (cell.notes.length > 0) {
        <div class="notes-grid">
                          @for (num of [1,2,3,4,5,6,7,8,9]; track num) {
                  <span class="note" 
                        [class.has-note]="cell.notes.includes(num)"
                        [class.note-error]="cell.notes.includes(num) && isNoteError(boxIndex, cellIndex, num)">
                    {{ cell.notes.includes(num) ? num : '' }}
                  </span>
                }
        </div>
      }
    </div>
  </div>
</div>
